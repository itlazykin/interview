# DB

[Виды БД и для чего их лучше использовать?](#виды-бд-и-для-чего-их-лучше-использовать)

[Масштабирование. Как решить нехватку места на сервере?](#масштабирование-как-решить-нехватку-места-на-сервере)

[Репликация базы данных. Что это такое](#репликация-базы-данных-что-это-такое)

[Что такое шардирование](#что-такое-шардирование)

[NoSQL vs SQL](#nosql-vs-sql)

[Партиционирование](#партиционирование)

# Виды БД и для чего их лучше использовать?

| Вид БД                   | Примеры               | Основное применение                            |
|--------------------------|-----------------------|------------------------------------------------|
| Реляционные              | MySQL, PostgreSQL     | Финансы, CRM, интернет-магазины                |
| Документоориентированные | MongoDB, CouchDB      | Гибкие структуры данных, профили пользователей |
| Графовые                 | Neo4j, OrientDB       | Анализ связей, социальные сети                 |
| Ключ-значение            | Redis, DynamoDB       | Кэширование, сессии                            |
| Колонноориентированные   | Cassandra, HBase      | Аналитика, большие данные                      |
| Временные                | InfluxDB, TimescaleDB | Метрики, IoT                                   |
| Объектно-ориентированные | ObjectDB              | CAD, моделирование                             |
| NewSQL                   | CockroachDB           | Масштабируемость, транзакции                   |

[К оглавлению](#DB)

# Масштабирование. Как решить нехватку места на сервере?

| Тип масштабирования          | Описание                                                                  | Решение проблемы нехватки места                                                                 |
|------------------------------|---------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|
| Вертикальное (Scaling Up)    | Увеличение ресурсов текущего сервера: больше процессоров, памяти, дисков. | Установка новых дисков, увеличение объема оперативной памяти, переход на более мощный сервер.   |
| Горизонтальное (Scaling Out) | Добавление дополнительных серверов, которые работают совместно.           | Разделение базы данных между несколькими серверами с использованием шардинга или кластеризации. |
| Архивирование данных         | Перемещение редко используемых данных в архив.                            | Снижение нагрузки и экономия места за счет переноса устаревших данных в отдельное хранилище.    |
| Использование облаков        | Хранение данных в облачных системах, таких как AWS, Azure, GCP.           | Масштабируемое хранилище с оплатой за используемый объем.                                       |
| Репликация данных            | Создание копий базы данных на других серверах для распределения нагрузки. | Разгрузка основного сервера за счет распределения запросов на чтение.                           |

[К оглавлению](#DB)

# Репликация базы данных. Что это такое

Репликация — это процесс создания и поддержания копий базы данных на нескольких серверах.
Она используется для обеспечения отказоустойчивости, увеличения производительности и масштабируемости.

### Типы репликации:

`Синхронная репликация`:
+ Данные копируются на реплику сразу после внесения изменений.
+ Высокая консистентность, но может снижать производительность.

`Асинхронная репликация`:
+ Данные копируются с задержкой.
+ Более производительная, но возможна временная несогласованность данных.

### Преимущества:

+ Увеличение отказоустойчивости. 
+ Балансировка нагрузки (например, чтение может выполняться с реплики). 
+ Географическое распределение данных для улучшения задержек.

### Пример использования репликации:

Master-Slave: Один главный сервер (master) обрабатывает запись, а копии (slave) отвечают за чтение.
Master-Master: Все узлы могут записывать и читать, требуется механизм разрешения конфликтов.

[К оглавлению](#DB)

# Что такое шардирование

Шардирование — это метод горизонтального масштабирования базы данных, при котором данные делятся на части (шарды) и распределяются между несколькими серверами. Каждый шард содержит только часть общего набора данных и работает как отдельная база данных.

### Как работает шардирование?

+ Данные разбиваются по определённому ключу (например, идентификатор пользователя, географический регион).
+ Каждая часть (шард) хранится на отдельном сервере или экземпляре базы данных.
+ При запросе система определяет, на каком шарде находятся нужные данные, и обращается к нему.

### Зачем нужно шардирование?

+ Масштабируемость: Увеличение объёма данных обрабатывается добавлением новых серверов. 
+ Производительность: Запросы выполняются быстрее, так как каждый сервер обрабатывает только часть данных. 
+ Изоляция: Ошибка на одном шарде не влияет на другие.

### Плюсы шардирования

+ Возможность обработки больших объёмов данных. 
+ Уменьшение нагрузки на каждый отдельный сервер. 
+ Горизонтальное масштабирование, которое дешевле, чем вертикальное.

### Минусы шардирования

+ Сложность реализации: Требуется правильное распределение данных между шардами. 
+ Обслуживание: Управление несколькими серверами сложнее. 
+ Перераспределение данных: Если количество серверов изменяется, данные нужно перераспределить.

[К оглавлению](#DB)

# NoSQL vs SQL

+ SQL (реляционные базы данных): Структурированные таблицы с чёткой схемой данных.
+ NoSQL (нереляционные базы данных): Гибкая структура для неструктурированных или полуструктурированных данных.

| Критерий           | SQL (реляционные)                           | NoSQL (нереляционные)                                  |
|--------------------|---------------------------------------------|--------------------------------------------------------|
| Структура данных   | Таблицы (строки и столбцы).                 | Документы, ключ-значение, графы, колонки.              |
| Схема              | Жёсткая, требуется заранее определить.      | Гибкая, можно изменять структуру данных.               |
| Язык запросов	     | SQL (стандартный язык запросов).            | API или специальные запросы (например, MongoDB Query). |
| Масштабируемость   | Вертикальная (добавление ресурсов серверу). | Горизонтальная (добавление серверов).                  |
| Целостность данных | Высокая (ACID-транзакции).                  | Может быть слабее, иногда поддерживается BASE.         |
| Скорость           | Оптимизировано для сложных операций и JOIN. | Высокая скорость для простых операций.                 |
| Когда использовать | Структурированные данные, сложные связи.    | Гибкие, быстро меняющиеся данные.                      |
| Примеры            | MySQL, PostgreSQL, Oracle.                  | MongoDB, Redis, Cassandra, Neo4j.                      |

[К оглавлению](#DB)

# Партиционирование

Партиционирование (Partitioning) – это разбиение большой таблицы на мелкие подтаблицы (партиции) для ускорения запросов и оптимизации работы БД.

### Ключевые преимущества:
+ Быстрые запросы – обработка меньшего объема данных. 
+ Легкое управление – удаление старых данных без влияния на всю таблицу. 
+ Балансировка нагрузки – равномерное распределение данных между серверами. 
+ Уменьшение блокировок – параллельный доступ к разным партициям.

### Виды партиционирования

1. `Горизонтальное партиционирование (Horizontal Partitioning)`

Данные разделяются по строкам, например, по дате, диапазону ID или географическому региону.

Плюсы: 
+ Ускоряет выборки, работа идет только с нужной партицией. 
+ Уменьшает нагрузку на БД.

Минусы:
+ Сложнее обновлять и поддерживать индексы.

2. `Вертикальное партиционирование (Vertical Partitioning)`

Разделение таблицы по столбцам. Данные хранятся в разных таблицах, но связаны по ID.

Плюсы:
+ Оптимизирует запросы (основные данные загружаются быстрее). 
+ Экономит память (холодные данные хранятся отдельно).

Минусы:
+ Усложняет SQL-запросы (нужно делать JOIN).

3. `Партиционирование по списку (List Partitioning)`

Каждая партиция содержит определенные значения из списка.

Плюсы:
+ Оптимизирует работу с данными по категориям.

Минусы:
+ Новые категории требуют пересоздания схемы.

4. `Хеш-партиционирование (Hash Partitioning)`

Данные распределяются по партициям по хеш-функции (например, id % N).

Плюсы:
+ Равномерное распределение нагрузки.

Минусы:
+ Невозможно предсказать, где окажется конкретная строка.

### Когда применять партиционирование?

+ Огромные таблицы (>10M записей). 
+ Частый доступ к конкретным диапазонам данных (по дате, стране и т. д.). 
+ Долгая обработка запросов – партиции помогают ускорить SELECT. 
+ Упрощение удаления старых данных – DROP PARTITION быстрее, чем DELETE.

Когда НЕ нужно:
+ Если таблица небольшая (<1M записей). 
+ Если данные часто обновляются (UPDATE в партициях может быть сложным). 
+ Если БД не поддерживает партиционирование (например, MySQL InnoDB до версии 5.7).