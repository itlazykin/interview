# Liquidbase

[1. Liquibase. Что это и для чего?](#1-liquibase-что-это-и-для-чего)

[2. Какие записи создаёт liquibase во время миграции?](#2-какие-записи-создаёт-liquibase-во-время-миграции)

[3. Зачем нужны инструменты миграции?](#3-зачем-нужны-инструменты-миграции)

# 1. Liquibase. Что это и для чего?

Liquibase — это инструмент для управления миграциями базы данных, который помогает разработчикам и администраторам баз данных поддерживать синхронизацию структуры базы данных с кодом приложения. Liquibase позволяет версионировать изменения в базе данных, отслеживать их и автоматически применять при обновлениях

[К оглавлению](#Liquidbase)

# 2. Какие записи создаёт liquibase во время миграции?

Liquibase автоматически создаёт и использует несколько служебных таблиц для отслеживания состояния миграций в базе данных

`DATABASECHANGELOG` Хранит информацию о выполненных миграциях (changelog-файлах).

| Поле          | Описание                                         |
|---------------|--------------------------------------------------|
| ID            | Уникальный идентификатор изменения               |
| AUTHOR        | Автор миграции                                   |
| FILENAME      | Путь к файлу миграции (например, changelog.xml). |
| DATEEXECUTED  | Дата выполнения изменения                        |
| ORDEREXECUTED | Порядок выполнения изменений                     |
| MD5SUM        | Хэш содержимого изменения для проверки           |

`DATABASECHANGELOGLOCK` Предотвращает одновременное выполнение миграций разными процессами

| Поле        | Описание                                                  |
|-------------|-----------------------------------------------------------|
| ID          | Идентификатор блокировки (обычно 1).                      |
| LOCKED      | Флаг (TRUE или FALSE), показывающий, занята ли блокировка |
| LOCKGRANTED | Время предоставления блокировки                           |
| LOCKEDBY    | Информация о процессе, который удерживает блокировку      |

[К оглавлению](#Liquidbase)

# 3. Зачем нужны инструменты миграции?

Инструменты миграции (например, Liquibase, Flyway) используются для управления изменениями в структуре базы данных в различных средах разработки.

`Основные цели`:

+ Автоматическое применение изменений базы данных (создание таблиц, добавление столбцов, индексов и т.д.). 
+ Позволяет вести историю всех изменений базы (версионирование). 
+ Разработчики могут синхронизировать свои изменения через централизованные файлы миграции. 
+ Изменения гарантированно применяются одинаково на всех окружениях (локально, тестовые, продакшн). 
+ Возможность отменить применённые миграции в случае ошибок. 
+ Инструменты предотвращают выполнение миграций двумя процессами одновременно (через блокировки).

[К оглавлению](#Liquidbase)